
dovecot.conf:175:  args = /etc/dovecot/sql/dovecot-dict-sql-userdb.conf
dovecot.conf:260:  sqlquota = mysql:/etc/dovecot/sql/dovecot-dict-sql-quota.conf
dovecot.conf:261:  sieve_after = mysql:/etc/dovecot/sql/dovecot-dict-sql-sieve_after.conf
dovecot.conf:262:  sieve_before = mysql:/etc/dovecot/sql/dovecot-dict-sql-sieve_before.conf
 
dovecot-dict-sql-passdb.conf
dovecot-dict-sql-quota.conf
dovecot-dict-sql-sieve_after.conf
dovecot-dict-sql-sieve_before.conf
dovecot-dict-sql-userdb.conf


userdb {
  args = /etc/dovecot/sql/dovecot-dict-sql-userdb.conf
  driver = sql
  skip = found
}

dict {
  sqlquota = mysql:/etc/dovecot/sql/dovecot-dict-sql-quota.conf
  sieve_after = mysql:/etc/dovecot/sql/dovecot-dict-sql-sieve_after.conf
  sieve_before = mysql:/etc/dovecot/sql/dovecot-dict-sql-sieve_before.conf
}



cat sql/dovecot-dict-sql-userdb.conf 
# Autogenerated by mailcow
driver = mysql
connect = "host=/var/run/mysqld/mysqld.sock dbname=mailcow user=mailcow password=NoOOhV8lF8CkH5QeDejGaQwXrTHm"
user_query = SELECT CONCAT(JSON_UNQUOTE(JSON_VALUE(attributes, '$.mailbox_format')), mailbox_path_prefix, '%d/%n/:VOLATILEDIR=/var/volatile/%u:INDEX=/var/vmail_index/%u') AS mail, '%s' AS protocol, 5000 AS uid, 5000 AS gid, concat('*:bytes=', quota) AS quota_rule FROM mailbox WHERE username = '%u' AND (active = '1' OR active = '2')
iterate_query = SELECT username FROM mailbox WHERE active = '1' OR active = '2';

cat sql/dovecot-dict-sql-quota.conf 
# Autogenerated by mailcow
connect = "host=/var/run/mysqld/mysqld.sock dbname=mailcow user=mailcow password=NoOOhV8lF8CkH5QeDejGaQwXrTHm"
map {
  pattern = priv/quota/storage
  table = quota2
  username_field = username
  value_field = bytes
}
map {
  pattern = priv/quota/messages
  table = quota2
  username_field = username
  value_field = messages
}

cat sql/dovecot-dict-sql-sieve_after.conf 
# Autogenerated by mailcow
connect = "host=/var/run/mysqld/mysqld.sock dbname=mailcow user=mailcow password=NoOOhV8lF8CkH5QeDejGaQwXrTHm"
map {
  pattern = priv/sieve/name/$script_name
  table = sieve_after
  username_field = username
  value_field = id
  fields {
    script_name = $script_name
  }
}
map {
  pattern = priv/sieve/data/$id
  table = sieve_after
  username_field = username
  value_field = script_data
  fields {
    id = $id
  }
}

cat sql/dovecot-dict-sql-sieve_before.conf 
# Autogenerated by mailcow
connect = "host=/var/run/mysqld/mysqld.sock dbname=mailcow user=mailcow password=NoOOhV8lF8CkH5QeDejGaQwXrTHm"
map {
  pattern = priv/sieve/name/$script_name
  table = sieve_before
  username_field = username
  value_field = id
  fields {
    script_name = $script_name
  }
}
map {
  pattern = priv/sieve/data/$id
  table = sieve_before
  username_field = username
  value_field = script_data
  fields {
    id = $id
  }
}

cat sql/dovecot-dict-sql-userdb.conf 
# Autogenerated by mailcow
driver = mysql
connect = "host=/var/run/mysqld/mysqld.sock dbname=mailcow user=mailcow password=NoOOhV8lF8CkH5QeDejGaQwXrTHm"
user_query = SELECT CONCAT(JSON_UNQUOTE(JSON_VALUE(attributes, '$.mailbox_format')), mailbox_path_prefix, '%d/%n/:VOLATILEDIR=/var/volatile/%u:INDEX=/var/vmail_index/%u') AS mail, '%s' AS protocol, 5000 AS uid, 5000 AS gid, concat('*:bytes=', quota) AS quota_rule FROM mailbox WHERE username = '%u' AND (active = '1' OR active = '2')
iterate_query = SELECT username FROM mailbox WHERE active = '1' OR active = '2';
